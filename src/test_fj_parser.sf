{-#
    INCLUDE "fj_parser.sf"
    INCLUDE "testfx.sf"
    INCLUDE "test_parser_helpers.sf"
#-}

let testFJExprVariable : TestFn = {
    name = "Test Varialbe a",
    fn   = \(__ : Unit) -> {
        assertParseStringResult[FJExpr]
            fjExprEq
            fjExprToString
            (FJVariable "a")
            fjExpr
            "a"
    }
};

let testFJFieldAccess : TestFn = {
    name = "Test Field Access",
    fn   = \(__ : Unit) -> {
        assertParseStringResult[FJExpr]
            fjExprEq
            fjExprToString
            (FJFieldAccess (FJVariable "a") "b")
            fjExpr
            "a.b"
    }
};

let testFJMethodInvoke : TestFn = {
    name = "Test Method Invoke",
    fn   = \(__ : Unit) ->
        assertParseStringResult[FJExpr]
            fjExprEq
            fjExprToString
            (FJMethodInvoke (FJVariable "a") "b" (Nil[FJExpr]))
            fjExpr
            "a.b()"
};

let testFJAllocate : TestFn = {
    name = "Test FJ Allocate",
    fn   = \(__ : Unit) -> {
        assertParseStringResult[FJExpr]
            fjExprEq
            fjExprToString
            (FJAllocate (FJType "A") (Nil[FJExpr]))
            fjExpr
            "new A()"
    }
};

let testFJParserSuite : TestSuite = {
    name = "Test Feather Weight Java parser",
    fns  = testFJExprVariable
                +>[TestFn] (testFJFieldAccess
                +>[TestFn] (testFJMethodInvoke
                +>[TestFn] (testFJAllocate
                +>[TestFn] (Nil[TestFn]))))
};
